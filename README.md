# Primitive NPC AI: 構造主観力学（SSD）に基づくシミュレーションシリーズ

## 概要

このリポジトリは、\*\*構造主観力学（Structural Subjectivity Dynamics: SSD）\*\*の理論モデルを実装し、原始的な世界のNPC（Non-Player Character）たちの行動と社会性の創発をシミュレートするPythonスクリプト群です。

各スクリプトは独立して実行可能であり、基本的なSSDコアモデルから、概日リズム、縄張り意識、そして高度な協力行動へと、段階的に複雑化していくNPCのAIの進化を示します。

## 構造主観力学（SSD）との関連

本シミュレーションの核心は、各NPCがSSDの数理モデルに基づいて意思決定を行う点にあります。NPCは以下の内部状態を持ち、環境からの**意味圧**（空腹、疲労、脅威など）に反応します。

  * **整合慣性 ($\kappa$)**: `kappa` - 特定の行動（採餌、休息など）の成功体験によって蓄積される「通りやすさ」。学習や習慣化を表します。
  * **未処理圧 (熱: $E$)**: `E` - 整合が追いつかない意味圧の蓄積量。ストレスやフラストレーションに相当します。
  * **跳躍閾値 ($\Theta$)**: `Theta` - 未処理圧がこの閾値を超えると、**跳躍**（非連続的な変化、このシミュレーションでは主に「死」）が確率的に発生します。
  * **探索温度 ($T$)**: `T` - 熱($E$)や行動の単調さ（退屈）によって上昇し、NPCの行動のランダム性（探索行動）を増加させます。

## シミュレーションの進化

各ファイルは、機能を追加・拡張していく形で構成されています。

### 1\. `SSDNPCAI.py` - 基礎モデル

  * 5体のNPCによる基本的な生存シミュレーション。
  * SSDの数理モデル（整合流、κの更新、熱の蓄積、跳躍判定）のコア部分を実装。
  * 行動選択は「休息」「採餌」「パトロール」「助け合い」の基本的なものに限られます。

### 2\. `SSDNPCAI2.py` - 概日リズムの導入

  * **昼夜サイクル** (`DayNightCycle`) を導入し、NPCの行動に時間的制約を追加。
  * NPCに**睡眠**の概念 (`sleep_debt`, `is_sleeping`) が実装され、疲労回復と**記憶の定着**（睡眠中のκ更新）が行われます。
  * 夜間の活動にはコスト増や成功率低下のペナルティが課せられます。

### 3\. `SSDNPCAI3.py` & `SSDNPCAI4.py` - 縄張り（Territory）意識

  * NPCが**縄張り** (`Territory`) を持つようになります。これは「ホーム」という空間的な構造です。
  * 縄張りの中心はNPCの活動に応じて移動し、他者の侵入を検知して威嚇、追跡、あるいは招待といった社会的な反応を示します。
  * 縄張り内での活動には\*\*「ホームボーナス」\*\*（睡眠の質向上、ストレス軽減など）があり、NPCに帰巣本能が生まれます。

### 4\. `priority_village_sim.py` - 優先度ベースの社会行動

  * NPCの意思決定が、より洗練された**優先度階層モデル**に進化。
      * L1: 生命維持のガードレール（飢餓、負傷）
      * L2: 協調行動（狩りの呼びかけ）
      * L3-5: 個人の欲求と社会的行動
  * **捕食者 (`Predator`)** が導入され、環境に新たな脅威（意味圧）が追加されます。
  * **集団での狩り (`rally_for_hunt`)** という高度な協力行動が実装されます。リーダーが呼びかけ、仲間が集まり、成功すれば大きな報酬を分かち合います。
  * **食料の貯蔵 (`food_store`)** や、より高度な社会関係（三者関係の形成、噂、社会的引力）がモデル化されます。

### 5\. `priority_village_sim2.py` - 戦闘力と防衛行動

  * `priority_village_sim.py`の改良版。
  * **戦闘力 (`combat_power`)** と**整合効率 (`alignment_inertia`)** という新しいパラメータを導入し、NPCの戦闘能力を動的に計算します。
  * 捕食者が特定のエリアに**留まる (`is_camping`)** ようになり、より持続的な脅威となります。
  * NPCは、留まっている捕食者に対して**防衛的な集団での狩り (`emit_rally_predator`)** を呼びかけることが可能になります。

## 実行方法

各スクリプトは単体で実行できます。ターミナルで以下のコマンドを実行してください。

```bash
python <ファイル名>.py
```

例:

```bash
python priority_village_sim2.py
```

実行が完了すると、シミュレーション結果のサマリーが表示され、分析グラフが `png` ファイルとして保存されます。

## 依存ライブラリ

  * `pandas`
  * `numpy`
  * `matplotlib`

これらのライブラリは、`pip` を使ってインストールできます。

```bash
pip install pandas numpy matplotlib
```

## 構造主観力学的な洞察

このシミュレーションシリーズは、単純なSSDの数理法則から、いかに複雑でリアルな社会現象が創発するかを示しています。

  * **死の力学**: NPCの死は、飢えや負傷といった生理的な意味圧が構造の限界を超えたときに発生する\*\*「跳躍」\*\*の一形態としてモデル化されています。
  * **縄張りの本質**: 縄張りは単なる空間ではなく、過去の成功体験（休息、採餌、協力）が刻まれた\*\*「空間的整合慣性」\*\*として機能します。縄張りへの愛着 (`attachment_strength`) が生存率を高めるという「ホームアドバンテージ」は、この構造的安定性がもたらす物理的な効果です。
  * **協力行動の創発**: 「集団での狩り」は、個々のNPCが飢餓という強い意味圧にさらされた際、単独での整合が困難なため、より大きな報酬を求めて\*\*「集団的整合」\*\*へと移行するプロセスです。脅威（捕食者）の存在は、この協力をさらに促進する強力な意味圧となります。
  * **社会の形成**: NPC間の関係性 (`rel`) や三者関係の形成は、個々の相互作用がより大きな社会構造を形成していく過程を示しています。「内（仲間）」と「外（侵入者）」を区別し、協力と競合を使い分ける行動は、社会性の基本的な力学を反映しています。

このプロジェクトは、SSDが単なる抽象理論ではなく、生命の行動原理や社会の進化を理解し、さらには人工的なエージェントに実装するための実践的なフレームワークであることを実証するものです。
